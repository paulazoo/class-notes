
F=[-1 -0.75 -0.5 -0.25 0 0.25 0.5 0.75 1;
-2 0.25 -1.25 0.5 -0.5 0.75 0.25 1 1;
0 1.75 -0.25 1 -0.5 0.25 -0.75 -0.5 -1];
% disp(mean(F,2))
[V,D]=eig((1/9).*F*F.')

%%
A=[-2.55 2.45;2.45 -2.55];
figure
hold on
[X,Y] = meshgrid(-1:0.1:1,-1:0.1:1);
X=X(:).';
Y=Y(:).';
gradient = A*[X;Y];
U = gradient(1,:);
V = gradient(2,:);

q = quiver(X,Y,U,V);

hold off

%%
U_A=[ 0.471, -0.0917, 0.877;
-0.869, 0.123, 0.48;
-0.152, -0.988, -0.0216];
ei=[0.877;0.48;-0.0216];
disp(A+(10.*(ei*ei.')))

%%
U_B=[ -0.411, 0.708, -0.0665;
-0.637, 0.403, 0.481;
0.651, -0.579, 0.874];

B=[ 4.83, 2.05, -0;
-4.65, 3.21, -7.63;
-1.89, -11.1, -4.04];

ei=[-0.0665;0.481;0.874];

disp( B- (ei*B(3,:)./0.874) )

%%
A=[ 0, -5.2, 9.2;
-4, 15.4, -15.4;
-4, 15.7, -15.7];
x0=[ 4.5;
2.5;
1.5];
[e_vecs,D]=eig(A);
lambda_vec=[0-4i, 0+4i, -0.3+0i];
e_l=[(-0.1630 - 0.9866i) 0 0; 0 (-0.1630 - 0.9866i) 0; 0 0 0.0202];
disp(expm(A*13))

%%
figure
hold on
[X,Y,Z] = meshgrid(0:2:5,0:2:5,0:2:5);
X=X(:).';
Y=Y(:).';
Z=Z(:).';
gradient = A*[X;Y;Z];
U = gradient(1,:);
V = gradient(2,:);
W = gradient(3,:);

q = quiver3(X,Y,Z,U,V,W);

t=0:0.1:20;
x=zeros(3,length(t));
for i=1:1:length(t)
    x(:,i)=e_vecs*diag(exp(lambda_vec*t(1,i)))*e_vecs^(-1)*x0;
end


plot3(x(1,:), x(2,:), x(3,:), 'm')

hold off